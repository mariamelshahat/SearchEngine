@model IEnumerable<SearchResult>
<style>
    .text-decoration-underline-hover:hover {
        text-decoration: underline;
    }

    .link-item:hover {
        background-color: rgba(0, 123, 255, 0.1); /* تغيير خلفية العنصر */
        box-shadow: 0 0 15px rgba(0, 123, 255, 0.6); /* إضافة ظل للعنصر */
        transform: translateY(-5px); /* رفع العنصر قليلاً */
        transition: all 0.3s ease; /* تأثير سلس عند التغيير */
    }
</style>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@500&display=swap" rel="stylesheet">

<div class="container mt-5">
    <div class="text-center mb-4">
        <img src="~/kookle-logo-circle.jpg" alt="Kookle Logo" style="width: 200px; height: auto;" class="mb-3" />
        <p class="lead text-muted" style="font-family: 'Roboto', sans-serif; font-size: 1.1rem;">
            Search for keywords in web pages ranked by relevance.
        </p>
    </div>

    <!-- Kookle-style Search Bar -->
    <div class="d-flex flex-column align-items-center mb-5">
        <form method="get" asp-action="Search" id="search-form" class="w-100" style="max-width: 700px;">
            <div class="input-group shadow rounded-pill overflow-hidden bg-white">
               
                <input type="text" name="query"
                       class="form-control border-0 text-center"
                       placeholder="Type a keyword to search..."
                       value="@Context.Request.Query["query"]"
                       style="height: 50px;" />
                @* <span class="input-group-text bg-white border-0">
                    🎤
                </span>
                <span class="input-group-text bg-white border-0">
                    📷
                </span> *@
                <span class="input-group-text bg-white border-0">
                    🔍
                </span>
            </div>

            <!-- Action Buttons -->
            <div class="text-center mt-4 d-flex justify-content-center gap-3">
                <button type="submit" class="btn btn-primary px-4 py-2 rounded-pill shadow-sm" name="sortBy" value="">
                    🔍 Search
                </button>
                <button type="submit" class="btn btn-outline-secondary px-4 py-2 rounded-pill shadow-sm" name="sortBy" value="count"> 
                     📊 Sort by Count
                </button>
            </div>
        </form>
    </div>



    <!-- Search Results -->
    @if (Model != null && Model.Any())
    {
        <div class="mb-5">
            <div class="d-flex flex-column gap-3">
                @foreach (var result in Model)
                {
                    <div class="border rounded-3 shadow-sm p-3 d-flex flex-column flex-md-row justify-content-between align-items-start link-item">
                        <div class="mb-2 mb-md-0">
                            <a href="@result.Url" target="_blank" class="fw-semibold link-primary text-decoration-underline-hover">
                                🌐 @result.Url
                            </a>
                        </div>
                        <div class="text-muted small">
                            <span class="badge bg-secondary">Count: @result.Count</span>
                        </div>
                        @* <div class="text-muted small"> *@
                        @*     <span class="badge bg-secondary">Page: @result.PageRank</span> *@
                        @* </div> *@
                    </div>
                }
            </div>
        </div>
    }
    else if (Context.Request.Query.ContainsKey("query"))
    {
        <div class="alert alert-info text-center mt-4 shadow-sm">
            No results found.
        </div>
    }
</div>

<!-- Audio Element for Sound -->
<audio id="search-sound" src="~/sounds/WhatsApp Audio 2025-05-06 at 17.35.29_e3251f8a.mp3" preload="auto"></audio>

@section Scripts {
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const form = document.getElementById("search-form");
            const sound = document.getElementById("search-sound");

            if (form && sound) {
                form.addEventListener("submit", function (event) {
                    event.preventDefault();  // Prevent immediate submission

                    // Play the sound
                    sound.play();

                    // Submit after sound ends
                    sound.onended = function () {
                        form.submit();
                    };
                });
            }
        });
    </script>
}
